(()=>{var e={};e.id=293,e.ids=[293],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},22057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},23259:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=r(50482),a=r(69108),i=r(62563),n=r.n(i),o=r(68300),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["(routes)",{children:["history",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,29676)),"C:\\Users\\Taha\\Desktop\\labvidix-frontend\\app\\(routes)\\history\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,27797)),"C:\\Users\\Taha\\Desktop\\labvidix-frontend\\app\\(routes)\\history\\layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,82917)),"C:\\Users\\Taha\\Desktop\\labvidix-frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\Taha\\Desktop\\labvidix-frontend\\app\\(routes)\\history\\page.tsx"],u="/(routes)/history/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(routes)/history/page",pathname:"/history",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},43870:(e,t,r)=>{Promise.resolve().then(r.bind(r,58775))},2674:(e,t,r)=>{Promise.resolve().then(r.bind(r,98340))},58775:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(95344),a=r(3952),i=r(3729),n=r.n(i);function o({children:e}){let[t,r]=n().useState(!1);return((0,i.useEffect)(()=>{r(!0)},[]),t)?s.jsx(s.Fragment,{}):null}new a.S},98340:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(95344);r(3729);var a=r(14821),i=r(82342),n=r.n(i),o=r(81271),l=r(98955),c=r(10832);let d=async()=>{let e=await l.Z.get("/package/get-packages");if(!e.data)throw Error("Error fetching packages");return e.data},u=()=>{let{data:e,isLoading:t,error:r,refetch:s,status:a,isError:i}=(0,o.a)({queryKey:["packages"],queryFn:d,refetchOnWindowFocus:!1,refetchOnMount:!0,enabled:!!c.Z()?.data?.id});return{data:e,isLoading:t,error:r,refetch:s,status:a,isError:i}};var h=r(72381);function p(){let{data:e,isLoading:t,isError:r,error:i}=u();return t?s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:s.jsx(h.Z,{status:h.q.Loading})}):r?s.jsx("div",{children:i?.message}):(0,s.jsxs)("div",{className:n().container,children:[e&&s.jsx(a.Z,{packages:e}),e?.length==0&&s.jsx("p",{children:"No data found"})]})}},14821:(e,t,r)=>{"use strict";r.d(t,{Z:()=>M});var s=r(95344),a=r(3729),i=r.n(a),n=r(41035),o=r.n(n),l=r(41223),c=r.n(l);let d={src:"/_next/static/media/edit.0ba936cb.svg",height:24,width:24,blurWidth:0,blurHeight:0},u={src:"/_next/static/media/chevron.2c4f9bb1.svg",height:24,width:24,blurWidth:0,blurHeight:0};var h=r(13892);let p={src:"/_next/static/media/download.1fa3ada2.svg",height:24,width:24,blurWidth:0,blurHeight:0},x={src:"/_next/static/media/arrow.bdebac8c.svg",height:24,width:24,blurWidth:0,blurHeight:0};var m=r(79718),g=r(77030),y=r.n(g);let _={src:"/_next/static/media/divider.b7b3919b.svg",height:24,width:2,blurWidth:0,blurHeight:0};var w=r(23875),f=r(25366),v=r.n(f),b=r(20783),j=r.n(b),k=r(48938),N=r(29554),q=r.n(N),D=r(56928),P=r.n(D),C=r(73644);let E=({src:e,alt:t,maxWidth:r=1024,maxHeight:i=768})=>{let[n,o]=(0,a.useState)({width:0,height:0});return(0,a.useEffect)(()=>{let t=new Image;return t.src=e,t.onload=()=>{let e=Math.min(r/t.width,i/t.height);o({width:Math.floor(t.width*e),height:Math.floor(t.height*e)})},()=>{t.onload=null}},[e,r,i]),s.jsx("img",{src:e,alt:t,width:n.width,height:n.height})},S=({isOpen:e,onClose:t,imgUrl:r})=>{let i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let r=r=>{i.current&&!i.current.contains(r.target)&&e&&t()};return window.addEventListener("click",r),()=>{window.removeEventListener("click",r)}},[t,e]),s.jsx(C.M,{children:e&&s.jsx(m.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999999},children:s.jsx(m.E.div,{initial:{scale:.5},animate:{scale:1},exit:{scale:.5},transition:{duration:.3},style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 0 10px rgba(0, 0, 0, 0.3)"},ref:i,children:s.jsx(E,{src:r,alt:"Logo"})})})})},T=e=>(console.log("current raw document",e.documentName),e.extractedFile.extractedData.map(t=>({DocumentName:e.documentName,DocumentURL:e.documentUrl,Text:t.Text,Type:t.Type}))),W=({rawDocuments:e})=>{let[t,r]=(0,a.useState)(""),[i,n]=(0,a.useState)(!1),l=async e=>{let t=T(e),r=new(P()).Workbook,s=r.addWorksheet("Sheet 1");s.columns=[{header:"DocumentName",key:"DocumentName",width:20},{header:"DocumentURL",key:"DocumentURL",width:20},{header:"Text",key:"Text",width:20},{header:"Type",key:"Type",width:20},{header:"Score",key:"Score",width:20}],t.forEach(e=>{s.addRow(e)});let a=await r.xlsx.writeBuffer();(0,k.saveAs)(new Blob([a]),`${e.documentName}_data.xlsx`)},d=(e,t)=>{t.stopPropagation(),r(e),n(!0)};return(0,s.jsxs)(m.E.ul,{className:o().collapseBodyWrapper,initial:{height:0,opacity:0,y:-10},animate:{height:"auto",opacity:1,y:0},exit:{height:0,opacity:0,y:-10},transition:{duration:.5},children:[e.map(e=>(0,s.jsxs)(m.E.li,{className:o().collapseBody,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},children:[(0,s.jsxs)("div",{className:o().fileNameWrapper,children:[s.jsx("div",{className:o().icon,children:s.jsx(c(),{src:h.Z,alt:"file",width:0,height:0})}),s.jsx("p",{children:e.documentName})]}),(0,s.jsxs)("div",{className:o().rightSection,children:[s.jsx("div",{className:o().icon,onClick:()=>l(e),children:s.jsx(c(),{src:p,alt:"edit",width:0,height:0})}),s.jsx("div",{className:o().icon,onClick:t=>d(e.documentUrl,t),children:s.jsx(c(),{src:x,alt:"arrow",width:0,height:0})})]})]},e._id)),s.jsx(S,{isOpen:i,onClose:()=>{r(""),n(!1)},imgUrl:t})]})},Y=({packageName:e,date:t,rawDocuments:r,onViewAll:i,onEdit:n,isCollapsed:l,id:h,onCollapse:p})=>{let[x,m]=(0,a.useState)(!1),[g,f]=(0,a.useState)(e),{mutateAsync:b,isSuccess:N,isError:D,error:C}=(0,w.s)(),[E,S]=(0,a.useState)(!1),W=async()=>{let t=new(q());for(let e=0;e<r.length;e++){let s=r[e],a=T(s),i=new(P()).Workbook,n=i.addWorksheet("Sheet 1");n.columns=[{header:"DocumentName",key:"DocumentName",width:20},{header:"DocumentURL",key:"DocumentURL",width:20},{header:"Text",key:"Text",width:20},{header:"Type",key:"Type",width:20}],a.forEach(e=>{n.addRow(e)});let o=await i.xlsx.writeBuffer();t.file(`${s.documentName}_data.xlsx`,o)}t.generateAsync({type:"blob"}).then(t=>{(0,k.saveAs)(t,`${e}.zip`)})};(0,a.useEffect)(()=>{N&&(m(!1),S(!1)),D&&(console.log(C),S(!1))},[N,D,C]);let Y=(0,a.useCallback)(async()=>{S(!0),await b({id:h,packageName:g})},[g]),M=()=>g!==e,A=y()(t,"DD/MM/YYYY HH:mm").format("DD/MM/YYYY HH:mm");return(0,s.jsxs)("div",{className:o().collapseHeader,children:[(0,s.jsxs)("div",{className:o().packageName,children:[x?s.jsx("input",{type:"text",value:g,onChange:e=>{f(e.target.value)},onBlur:()=>{M()?Y():m(!1)},onKeyDown:e=>{"Enter"===e.key&&(M()?Y():m(!1))},autoFocus:!0}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("h2",{children:g}),s.jsx("div",{className:o().icon,onClick:()=>{n(),m(!0)},children:s.jsx(c(),{src:d,alt:"edit",width:0,height:0})})]}),E&&s.jsx("div",{className:o().icon,children:s.jsx(v(),{color:"#3A3A49",size:24})})]}),(0,s.jsxs)("div",{className:o().dateWrapper,children:[s.jsx("p",{children:A.split(" ")[0]}),s.jsx(c(),{src:_,alt:"divider",width:0,height:0}),s.jsx("p",{children:A.split(" ")[1]})]}),s.jsx("button",{className:o().downloadButton,onClick:W,children:"Download all"}),s.jsx(j(),{className:o().viewAll,href:`/results/${h}`,children:"View all"}),s.jsx("button",{className:`
          ${o().caret} 
          ${l?o().up:o().down}
        `,onClick:p,children:s.jsx(c(),{src:u,alt:"caret",width:0,height:0})})]})},M=({packages:e})=>{let t=e?.sort((e,t)=>y()(e.createdAt,"DD/MM/YYYY HH:mm").isBefore(y()(t.createdAt,"DD/MM/YYYY HH:mm"))?1:-1),[r,n]=(0,a.useState)(t.map(()=>!1)),l=(0,a.useCallback)(e=>t.findIndex(t=>t._id===e),[t]),c=e=>{let t=l(e);n(e=>{let r=[...e];return r[t]=!r[t],r})};return s.jsx("section",{className:o().container,children:t?.map(e=>s.jsxs(i().Fragment,{children:[s.jsx(Y,{packageName:e.packageName,id:e._id,date:e.createdAt,rawDocuments:e.rawDocuments,onViewAll:()=>{},onEdit:()=>{},isCollapsed:r[l(e._id)],onCollapse:()=>c(e?._id)}),!r[l(e._id)]&&s.jsx(W,{rawDocuments:e.rawDocuments})]},e._id))})}},41035:e=>{e.exports={container:"styles_container__O72FL",collapseHeader:"styles_collapseHeader__8fhmE",packageName:"styles_packageName__s3OrL",icon:"styles_icon__GlP80",dateWrapper:"styles_dateWrapper__P6bqC",downloadButton:"styles_downloadButton__iAT1U",viewAll:"styles_viewAll__R3YYG",caret:"styles_caret__NhJkL",up:"styles_up__JiH_v",down:"styles_down__Xh3PF",collapseBody:"styles_collapseBody__ygx09",fileNameWrapper:"styles_fileNameWrapper__JXlGV",rightSection:"styles_rightSection__ldSlY",collapseBodyWrapper:"styles_collapseBodyWrapper__NPYz1"}},82342:e=>{e.exports={container:"history_container__CWaKp"}},27797:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let s=(0,r(86843).createProxy)(String.raw`C:\Users\Taha\Desktop\labvidix-frontend\app\(routes)\history\layout.tsx`),{__esModule:a,$$typeof:i}=s,n=s.default},29676:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let s=(0,r(86843).createProxy)(String.raw`C:\Users\Taha\Desktop\labvidix-frontend\app\(routes)\history\page.tsx`),{__esModule:a,$$typeof:i}=s,n=s.default}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[595,193,383,89],()=>r(23259));module.exports=s})();